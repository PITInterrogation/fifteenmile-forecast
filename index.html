<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fifteenmile Creek Water Temperature Forecast</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=IBM+Plex+Mono:wght@400;500&display=swap');
:root{
  --bg:#ffffff;--sf:#f7f8fa;--sf2:#eef1f5;--sf3:#e4e9f0;
  --bd:#d0d7e0;--bdl:#b8c2cf;
  --tx:#374151;--txd:#6b7b8d;--txb:#1a2332;
  --ac:#1a73b5;--ac2:#2b8fd6;
  --gn:#2e8b3d;--rd:#c62828;--or:#e65100;--yl:#f59e0b;--pu:#6d4c9e;
  --f:'Source Sans 3',-apple-system,sans-serif;
  --m:'IBM Plex Mono','Consolas',monospace;
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--tx);font-family:var(--f);line-height:1.55}
.hdr{background:linear-gradient(160deg,#1a5276,#1a73b5 50%,#2185c5);border-bottom:2px solid #1565a0;padding:2rem 2rem 1.7rem;position:relative}
.hdr-in{max-width:1280px;margin:0 auto}
.hdr h1{font-size:1.6rem;font-weight:700;color:#ffffff;letter-spacing:-.01em}
.hdr .sub{color:rgba(255,255,255,.8);font-size:.9rem;margin-top:.1rem}
.ri{display:flex;gap:1.4rem;margin-top:.55rem;font-size:.76rem;font-family:var(--m);flex-wrap:wrap}
.ri span{color:rgba(255,255,255,.9);opacity:.9}
.ab{border-radius:8px;padding:.8rem 1.3rem;margin:1.1rem auto 0;max-width:1280px;display:flex;align-items:center;gap:.65rem;font-weight:500;font-size:.88rem}
.alert-active{background:#fef2f2;border:1px solid #fca5a5}
.alert-active .adot{width:9px;height:9px;background:var(--rd);border-radius:50%;animation:bk 1.8s infinite}
.alert-active .atx{color:var(--rd);font-weight:700}
@keyframes bk{0%,100%{opacity:1}50%{opacity:.15}}
.alert-cancelled{background:#ecfdf5;border:1px solid #6ee7b7}
.alert-cancelled .adot{width:9px;height:9px;background:#059669;border-radius:50%}
.alert-cancelled .atx{color:#065f46;font-weight:700}
.alert-ok{background:#f0fdf4;border:1px solid #86efac}
.alert-ok .adot{width:9px;height:9px;background:var(--gn);border-radius:50%}
.alert-ok .atx{color:var(--gn)}
.ctr{max-width:1280px;margin:0 auto;padding:1rem 2rem 3rem}
.cd{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:1.3rem 1.5rem;margin-bottom:1.1rem}
.cd h3{font-size:.78rem;font-weight:600;color:var(--txd);text-transform:uppercase;letter-spacing:.06em;margin-bottom:.8rem}
.cw{position:relative;width:100%}
.cw canvas{width:100%!important}
.ws{display:grid;grid-template-columns:repeat(auto-fit,minmax(115px,1fr));gap:.55rem}
.wx-card{background:#ffffff;border:1px solid var(--bd);border-radius:8px;padding:.85rem .6rem;text-align:center;transition:border-color .2s,box-shadow .2s}
.wx-card:hover{border-color:var(--bdl);box-shadow:0 2px 8px rgba(0,0,0,.06)}
.wx-card.today-card{border-color:var(--ac);background:#eff8ff;box-shadow:0 2px 8px rgba(26,115,181,.1)}
.wx-day{font-weight:600;font-size:.8rem;color:var(--txb)}
.wx-date{font-size:.7rem;color:var(--txd);margin-bottom:.35rem}
.wx-icon{font-size:1.9rem;line-height:1.2;margin:.15rem 0}
.wx-cond{font-size:.72rem;color:var(--txd);margin-bottom:.25rem}
.wx-temp{font-size:1.05rem;font-weight:600;color:var(--txb)}
.wx-c{display:block;font-size:.74rem;font-weight:400;color:var(--txd)}
.wx-det{font-size:.65rem;color:var(--txd);margin-top:.2rem;font-family:var(--m)}
.lg{display:flex;gap:.8rem;flex-wrap:wrap;align-items:center;color:var(--txd)}
.lgi{display:flex;align-items:center;gap:.3rem;font-size:.72rem}
.ll{display:inline-block;width:18px;height:3px;border-radius:2px}
.ld{display:inline-block;width:18px;height:0;border-top:2px dashed}
.cls{display:flex;gap:0;margin:.25rem 0 .55rem;font-size:.68rem;color:var(--txd)}
.clb{padding:.18rem .55rem;border-radius:3px;margin-right:2px;font-weight:600}
.csub{display:block;font-size:.62rem;color:var(--txd);line-height:1.1}
table{width:100%;border-collapse:collapse;font-size:.8rem}
th{text-align:left;padding:.5rem .6rem;background:var(--sf2);color:var(--txd);font-weight:500;font-size:.7rem;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid var(--bd);white-space:nowrap}
td{padding:.45rem .6rem;border-bottom:1px solid #e5e9ef;font-family:var(--m);font-size:.76rem;white-space:nowrap}
.tdate{font-family:var(--f);font-weight:500;color:var(--txb)}
.tsrc{font-family:var(--f);font-size:.68rem;color:var(--txd)}
tr.today td{background:#eff8ff}
tr.today .tdate{color:var(--ac)}
tr.forecast td{color:var(--ac2)}
tr:hover td{background:#f0f5fa}
.ft{text-align:center;font-size:.7rem;color:var(--txd);padding:1.4rem 2rem;border-top:1px solid var(--bd)}
</style>
</head>
<body>
<div class="hdr"><div class="hdr-in">
  <h1>Fifteenmile Creek Water Temperature Forecast</h1>
  <div class="sub">Dufur (upper sites) &mdash; The Dalles (lower sites) &mdash; SNOTEL Red Hill (712)</div>
  <div class="ri">
    <span>Forecast: Friday, February 20, 2026</span>
    <span>Upper alert: 22&deg;C / 72&deg;F</span>
    <span>Lower alert: 23&deg;C / 73&deg;F</span>
  </div>
</div></div>

<div class="ctr" style="padding-bottom:0"><div class="ab alert-ok"><div class="adot"></div><div class="atx">Water temperatures are below alert thresholds.</div></div></div>

<div class="ctr">
  <div class="cd">
    <h3>7-Day Weather Forecast &mdash; The Dalles, OR</h3>
    <div class="ws"><div class="wx-card today-card"><div class="wx-day">Today</div><div class="wx-date">Feb 20</div><div class="wx-icon">&#x2601;</div><div class="wx-cond">Cloudy</div><div class="wx-temp">33&deg;F<span class="wx-c">1&deg;C</span></div><div class="wx-det">RH 81%</div></div>
<div class="wx-card"><div class="wx-day">Sat</div><div class="wx-date">Feb 21</div><div class="wx-icon">&#x2601;</div><div class="wx-cond">Cloudy</div><div class="wx-temp">35&deg;F<span class="wx-c">2&deg;C</span></div><div class="wx-det">RH 82%</div></div>
<div class="wx-card"><div class="wx-day">Sun</div><div class="wx-date">Feb 22</div><div class="wx-icon">&#x2601;</div><div class="wx-cond">Cloudy</div><div class="wx-temp">37&deg;F<span class="wx-c">3&deg;C</span></div><div class="wx-det">RH 85%</div></div>
<div class="wx-card"><div class="wx-day">Mon</div><div class="wx-date">Feb 23</div><div class="wx-icon">&#x1F327;</div><div class="wx-cond">Rain</div><div class="wx-temp">42&deg;F<span class="wx-c">5&deg;C</span></div><div class="wx-det">RH 94%</div></div>
<div class="wx-card"><div class="wx-day">Tue</div><div class="wx-date">Feb 24</div><div class="wx-icon">&#x1F327;</div><div class="wx-cond">Rain</div><div class="wx-temp">43&deg;F<span class="wx-c">6&deg;C</span></div><div class="wx-det">RH 89%</div></div>
<div class="wx-card"><div class="wx-day">Wed</div><div class="wx-date">Feb 25</div><div class="wx-icon">&#x2601;</div><div class="wx-cond">Cloudy</div><div class="wx-temp">40&deg;F<span class="wx-c">4&deg;C</span></div><div class="wx-det">RH 82%</div></div>
<div class="wx-card"><div class="wx-day">Thu</div><div class="wx-date">Feb 26</div><div class="wx-icon">&#x2601;</div><div class="wx-cond">Cloudy</div><div class="wx-temp">42&deg;F<span class="wx-c">5&deg;C</span></div><div class="wx-det">RH 82%</div></div>
</div>
  </div>
  
<div class="cd">
  <h3>Water Temperature &mdash; All Sites</h3>
  <div class="cls">
    <div class="clb" style="background:#0369a1;color:#ffffff">&lt;10&deg;C Cold</div>
    <div class="clb" style="background:#15803d;color:#ffffff">10-18&deg;C Normal</div>
    <div class="clb" style="background:#a16207;color:#ffffff">18-21&deg;C Warm</div>
    <div class="clb" style="background:#c2410c;color:#ffffff">21-23&deg;C High</div>
    <div class="clb" style="background:#b91c1c;color:#ffffff">&ge;23&deg;C Alert</div>
  </div>
  <div class="lg" style="margin:.4rem 0 .5rem"><span class="lgi"><div style="width:20px;height:0;border-top:3px solid #1d4ed8;display:inline-block"></div> Pine Creek</span>
<span class="lgi"><div style="width:20px;height:0;border-top:3px solid #15803d;display:inline-block"></div> Moody (Fifteenmile Ck)</span>
<span class="lgi"><div style="width:20px;height:0;border-top:3px dashed #7c3aed;display:inline-block"></div> Kaser Bridge (Fifteenmile Ck)</span>
<span class="lgi"><div style="width:20px;height:0;border-top:3px dashed #0e7490;display:inline-block"></div> 15/8 Mile Confluence</span>
<span class="lgi"><div style="width:20px;height:0;border-top:3px dashed #4338ca;display:inline-block"></div> Eightmile Creek</span>
</div>
  <div class="cw"><canvas id="tempChart" height="240"></canvas></div>
</div>
  
<div class="cd">
  <h3>Discharge (cfs) &mdash; All Sites</h3>
  <div class="lg" style="margin-bottom:.5rem">
    <span class="lgi"><div class="ll" style="background:#1d4ed8"></div> Pine Creek</span>
<span class="lgi"><div class="ll" style="background:#15803d"></div> Moody (Fifteenmile Ck)</span>
<span class="lgi"><div class="ll" style="background:#7c3aed"></div> Kaser Bridge (Fifteenmile Ck)</span>
<span class="lgi"><div class="ll" style="background:#0e7490"></div> 15/8 Mile Confluence</span>
<span class="lgi"><div class="ll" style="background:#4338ca"></div> Eightmile Creek</span>

    <span class="lgi" style="margin-left:.6rem;font-size:.65rem;color:var(--txd)">
      solid = observed &nbsp; dashed = predicted</span>
  </div>
  <div class="cw"><canvas id="flowChart" height="180"></canvas></div>
</div>
  
<div class="cd" style="overflow-x:auto">
  <h3>Daily Detail &mdash; All Sites</h3>
  <table><thead><tr>
    <th>Date</th><th>Src</th>
    <th style="color:#1d4ed8">Pine Creek<span class="csub">&deg;C (&deg;F)</span></th>
<th style="color:#15803d">Moody<span class="csub">&deg;C (&deg;F)</span></th>
<th style="color:#7c3aed">Kaser Bridge<span class="csub">&deg;C (&deg;F)</span></th>
<th style="color:#0e7490">15/8 Mile Confluence<span class="csub">&deg;C (&deg;F)</span></th>
<th style="color:#4338ca">Eightmile Creek<span class="csub">&deg;C (&deg;F)</span></th>

    <th>Air &deg;F</th><th>RH%</th>
  </tr></thead><tbody><tr class="observed"><td class="tdate">Tue Feb 17</td><td class="tsrc">Obs</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.4 (38.0)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.5 (40.1)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.9 (40.8)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.0 (40.9)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.0 (41.0)</td>
<td>37</td><td>81</td></tr>
<tr class="observed"><td class="tdate">Wed Feb 18</td><td class="tsrc">Obs</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">2.4 (36.3)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.6 (38.5)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.0 (39.3)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.4 (39.9)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.2 (39.6)</td>
<td>37</td><td>77</td></tr>
<tr class="observed"><td class="tdate">Thu Feb 19</td><td class="tsrc">Obs</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">2.8 (37.0)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.6 (38.5)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.9 (39.0)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.2 (39.6)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.5 (40.0)</td>
<td>38</td><td>78</td></tr>
<tr class="today"><td class="tdate">Today</td><td class="tsrc">Obs</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">2.3 (36.2)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.0 (37.3)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.3 (37.9)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.9 (39.0)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.5 (38.2)</td>
<td>33</td><td>81</td></tr>
<tr class="forecast"><td class="tdate">Sat Feb 21</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">1.9 (35.4)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.1 (37.5)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.2 (37.8)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.7 (38.7)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.3 (37.9)</td>
<td>35</td><td>82</td></tr>
<tr class="forecast"><td class="tdate">Sun Feb 22</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">2.1 (35.8)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.7 (38.7)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.5 (38.3)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.0 (39.2)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.8 (38.9)</td>
<td>37</td><td>85</td></tr>
<tr class="forecast"><td class="tdate">Mon Feb 23</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.5 (38.4)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.5 (42.0)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.5 (40.2)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.7 (40.5)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.2 (41.4)</td>
<td>42</td><td>94</td></tr>
<tr class="forecast"><td class="tdate">Tue Feb 24</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.7 (38.6)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.6 (42.2)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.8 (40.6)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.9 (40.8)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.5 (41.9)</td>
<td>43</td><td>89</td></tr>
<tr class="forecast"><td class="tdate">Wed Feb 25</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.4 (38.1)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.1 (41.1)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.6 (40.3)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.9 (40.8)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.0 (41.0)</td>
<td>40</td><td>82</td></tr>
<tr class="forecast"><td class="tdate">Thu Feb 26</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">3.8 (38.8)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.5 (41.9)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.1 (41.2)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.3 (41.6)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.6 (42.1)</td>
<td>42</td><td>82</td></tr>
<tr class="forecast"><td class="tdate">Fri Feb 27</td><td class="tsrc">Fcst</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">4.2 (39.5)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">6.0 (42.7)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.6 (42.1)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">5.8 (42.4)</td>
<td style="background:#eff6ff;color:#0369a1;font-weight:600">6.2 (43.2)</td>
<td>43</td><td>80</td></tr>
</tbody></table>
</div>
</div>

<div class="ft">
  Fifteenmile Creek Water Temperature Prediction System &bull;
  Oregon Department of Fish &amp; Wildlife &bull;
  Generated 2026-02-20
</div>

<script>
Chart.register(ChartDataLabels);
(function(){
const LB=['Tue Feb 17','Wed Feb 18','Thu Feb 19','Fri Feb 20','Sat Feb 21','Sun Feb 22','Mon Feb 23','Tue Feb 24','Wed Feb 25','Thu Feb 26','Fri Feb 27'];
const TI=3,AC=22.0,AF=71.60;
const MAXC=[5.0,4.39,4.45,3.86,3.74,3.99,5.54,5.64,5.07,5.6,6.23];
const tc_pinecreek=[3.36,2.4,2.76,2.32,1.92,2.12,3.53,3.67,3.39,3.77,4.18];
const tf_pinecreek=[38.05,36.32,36.97,36.18,35.45,35.83,38.36,38.6,38.1,38.79,39.52];
const tc_moody=[4.5,3.59,3.6,2.96,3.05,3.7,5.54,5.64,5.07,5.5,5.96];
const tf_moody=[40.09,38.46,38.48,37.33,37.49,38.66,41.97,42.16,41.12,41.91,42.74];
const tc_kaser=[4.91,4.03,3.89,3.25,3.21,3.53,4.54,4.8,4.62,5.12,5.63];
const tf_kaser=[40.83,39.26,39.01,37.86,37.78,38.35,40.17,40.65,40.31,41.21,42.13];
const tc_fifteeneight=[4.97,4.39,4.2,3.86,3.74,3.99,4.73,4.86,4.88,5.32,5.8];
const tf_fifteeneight=[40.95,39.89,39.56,38.96,38.73,39.18,40.51,40.76,40.79,41.57,42.44];
const tc_eightmile=[5.0,4.21,4.45,3.46,3.26,3.84,5.2,5.47,5.01,5.6,6.23];
const tf_eightmile=[40.99,39.58,40.01,38.22,37.87,38.91,41.36,41.85,41.02,42.09,43.21];

const CF={family:"'Source Sans 3'"};
const MO={family:"'IBM Plex Mono'",size:9};
const SD={grid:{color:'rgba(0,0,0,.07)'},ticks:{color:'#6b7b8d',font:MO}};
const TT={backgroundColor:'#fff',borderColor:'#d0d7e0',borderWidth:1,
          titleColor:'#1a2332',bodyColor:'#374151',padding:8,cornerRadius:5,
          titleFont:CF,bodyFont:{...MO,size:11}};

function tzColor(c){
  if(c===null||c===undefined)return null;
  if(c>=23)return 'rgba(254,226,226,0.55)';
  if(c>=21)return 'rgba(255,237,213,0.45)';
  if(c>=18)return 'rgba(254,249,195,0.35)';
  if(c>=10)return 'rgba(220,252,231,0.25)';
  return 'rgba(224,242,254,0.20)';
}
function tcol(c){
  if(c===null||c===undefined)return '#94a3b8';
  if(c>=23) return '#b91c1c';
  if(c>=21) return '#c2410c';
  if(c>=18) return '#a16207';
  if(c>=10) return '#15803d';
  return '#0369a1';
}

const ZONES={
  id:'zones',
  beforeDatasetsDraw(ch){
    const c=ch.ctx,x=ch.scales.x,y=ch.scales.y;
    if(!x||!y)return;
    const n=LB.length;
    c.save();
    for(let i=0;i<n;i++){
      const mc=MAXC[i];
      const col=tzColor(mc);
      if(!col)continue;
      const cx=x.getPixelForValue(i);
      let left,right;
      if(i===0){left=x.left;}else{left=(x.getPixelForValue(i-1)+cx)/2;}
      if(i===n-1){right=x.right;}else{right=(cx+x.getPixelForValue(i+1))/2;}
      c.fillStyle=col;
      c.fillRect(left,y.top,right-left,y.bottom-y.top);
      if(mc>=23){c.fillStyle='rgba(185,28,28,0.12)';c.fillRect(left,y.top,right-left,4);}
    }
    if(TI>=0){
      const px=x.getPixelForValue(TI);
      c.fillStyle='rgba(26,115,181,.04)';
      c.fillRect(px,y.top,x.right-px,y.bottom-y.top);
      c.strokeStyle='rgba(26,115,181,.35)';c.lineWidth=1;c.setLineDash([5,4]);
      c.beginPath();c.moveTo(px,y.top);c.lineTo(px,y.bottom);c.stroke();
      c.setLineDash([]);
      c.fillStyle='rgba(26,115,181,.6)';c.font="bold 10px 'Source Sans 3'";
      c.textAlign='right';c.fillText('\u25C0 Observed',px-6,y.top+14);
      c.textAlign='left';c.fillText('Forecast \u25B6',px+6,y.top+14);
    }
    c.strokeStyle='rgba(185,28,28,.4)';c.lineWidth=1;c.setLineDash([4,4]);
    const ay=y.getPixelForValue(AF);
    c.beginPath();c.moveTo(x.left,ay);c.lineTo(x.right,ay);c.stroke();
    c.setLineDash([]);
    c.fillStyle='rgba(185,28,28,.5)';c.font="10px 'IBM Plex Mono'";
    c.textAlign='right';c.fillText(AC+'\u00b0C alert',x.right-4,ay-4);
    c.restore();
  }
};

const DS=[
  {label:'Pine Creek',data:tf_pinecreek,borderColor:'#1d4ed8',borderWidth:2.5,pointRadius:7,pointHoverRadius:9,pointBackgroundColor:tc_pinecreek.map(c=>tcol(c)),pointBorderColor:'#1d4ed8',pointBorderWidth:1.5,pointStyle:'circle',tension:.25,fill:false,spanGaps:false,datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===0;},formatter:(v,c)=>{const cv=tc_pinecreek[c.dataIndex];return cv!==null?cv.toFixed(1)+'\u00b0':''},color:c=>tcol(tc_pinecreek[c.dataIndex]),anchor:'end',align:'top',offset:6,font:{family:"'IBM Plex Mono'",size:10,weight:600},}},
  {label:'Moody (Fifteenmile Ck)',data:tf_moody,borderColor:'#15803d',borderWidth:2.5,pointRadius:7,pointHoverRadius:9,pointBackgroundColor:tc_moody.map(c=>tcol(c)),pointBorderColor:'#15803d',pointBorderWidth:1.5,pointStyle:'circle',tension:.25,fill:false,spanGaps:false,datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===1;},formatter:(v,c)=>{const cv=tc_moody[c.dataIndex];return cv!==null?cv.toFixed(1)+'\u00b0':''},color:c=>tcol(tc_moody[c.dataIndex]),anchor:'start',align:'bottom',offset:6,font:{family:"'IBM Plex Mono'",size:10,weight:600},}},
  {label:'Kaser Bridge (Fifteenmile Ck)',data:tf_kaser,borderColor:'#7c3aed',borderDash:[6,3],borderWidth:2.2,pointRadius:7,pointHoverRadius:9,pointBackgroundColor:tc_kaser.map(c=>tcol(c)),pointBorderColor:'#7c3aed',pointBorderWidth:1.5,pointStyle:'rectRot',tension:.25,fill:false,spanGaps:false,datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===2;},formatter:(v,c)=>{const cv=tc_kaser[c.dataIndex];return cv!==null?cv.toFixed(1)+'\u00b0':''},color:c=>tcol(tc_kaser[c.dataIndex]),anchor:'end',align:'top',offset:6,font:{family:"'IBM Plex Mono'",size:10,weight:600},}},
  {label:'15/8 Mile Confluence',data:tf_fifteeneight,borderColor:'#0e7490',borderDash:[2,3],borderWidth:2.2,pointRadius:7,pointHoverRadius:9,pointBackgroundColor:tc_fifteeneight.map(c=>tcol(c)),pointBorderColor:'#0e7490',pointBorderWidth:1.5,pointStyle:'triangle',tension:.25,fill:false,spanGaps:false,datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===3;},formatter:(v,c)=>{const cv=tc_fifteeneight[c.dataIndex];return cv!==null?cv.toFixed(1)+'\u00b0':''},color:c=>tcol(tc_fifteeneight[c.dataIndex]),anchor:'start',align:'bottom',offset:6,font:{family:"'IBM Plex Mono'",size:10,weight:600},}},
  {label:'Eightmile Creek',data:tf_eightmile,borderColor:'#4338ca',borderDash:[8,3,2,3],borderWidth:2.0,pointRadius:7,pointHoverRadius:9,pointBackgroundColor:tc_eightmile.map(c=>tcol(c)),pointBorderColor:'#4338ca',pointBorderWidth:1.5,pointStyle:'rect',tension:.25,fill:false,spanGaps:false,datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===4;},formatter:(v,c)=>{const cv=tc_eightmile[c.dataIndex];return cv!==null?cv.toFixed(1)+'\u00b0':''},color:c=>tcol(tc_eightmile[c.dataIndex]),anchor:'end',align:'top',offset:6,font:{family:"'IBM Plex Mono'",size:10,weight:600},}},
];
new Chart(document.getElementById('tempChart'),{
  type:'line',data:{labels:LB,datasets:DS},
  options:{
    responsive:true,maintainAspectRatio:true,animation:{duration:500},
    layout:{padding:{top:28,bottom:8}},
    interaction:{mode:'index',intersect:false},
    plugins:{
      legend:{display:false},
      tooltip:{...TT,callbacks:{
        label:c=>{const f=c.parsed.y;const cv=(f-32)*5/9;
          return c.dataset.label+': '+f.toFixed(1)+'\u00b0F ('+cv.toFixed(1)+'\u00b0C)'},
      }},
    },
    scales:{
      x:{...SD,ticks:{...SD.ticks,maxRotation:45}},
      y:{...SD,position:'left',
        title:{display:true,text:'Temperature (\u00b0F)',color:'#6b7b8d',font:CF},
        afterDataLimits(ax){
          const minF25C=77;if(ax.max<minF25C)ax.max=minF25C;
          const pad=(ax.max-ax.min)*0.1||3;
          ax.min=ax.min-pad;ax.max=ax.max+pad;
        },
      },
      yC:{...SD,position:'right',grid:{drawOnChartArea:false},
        title:{display:true,text:'Temperature (\u00b0C)',color:'#6b7b8d',font:CF},
        afterBuildTicks(ax){
          const yF=ax.chart.scales.y;
          if(yF){ax.min=(yF.min-32)*5/9;ax.max=(yF.max-32)*5/9}
        },
        ticks:{...SD.ticks,callback:v=>v.toFixed(0)+'\u00b0'},
      },
    },
  },
  plugins:[ZONES],
});
})();

(function(){
const FLB=['Tue Feb 17','Wed Feb 18','Thu Feb 19','Fri Feb 20','Sat Feb 21','Sun Feb 22','Mon Feb 23','Tue Feb 24','Wed Feb 25','Thu Feb 26','Fri Feb 27'],FTI=3;
const fo_pinecreek=[30.8,30.8,30.8,30.2,null,null,null,null,null,null,null],fp_pinecreek=[null,null,null,30.2,26.5,27.2,27.8,28.9,35.6,38.9,42.4];
const fo_moody=[45.3,45.5,45.7,45.1,null,null,null,null,null,null,null],fp_moody=[null,null,null,45.1,43.0,41.7,41.1,40.9,41.7,42.2,42.3];
const fo_kaser=[43.6,43.5,43.7,43.4,null,null,null,null,null,null,null],fp_kaser=[null,null,null,43.4,34.1,31.0,31.3,30.9,30.8,30.6,30.5];
const fo_fifteeneight=[62.9,62.7,62.2,61.4,null,null,null,null,null,null,null],fp_fifteeneight=[null,null,null,61.4,54.8,54.4,56.4,62.5,67.9,68.7,69.2];
const fo_eightmile=[35.5,36.0,41.9,40.3,null,null,null,null,null,null,null],fp_eightmile=[null,null,null,40.3,25.3,23.4,22.9,23.0,23.7,24.1,24.6];

const CF={family:"'Source Sans 3'"};
const MO={family:"'IBM Plex Mono'",size:9};
const SD={grid:{color:'rgba(0,0,0,.07)'},ticks:{color:'#6b7b8d',font:MO}};
const TT={backgroundColor:'#fff',borderColor:'#d0d7e0',borderWidth:1,
          titleColor:'#1a2332',bodyColor:'#374151',padding:8,cornerRadius:5,
          titleFont:CF,bodyFont:{...MO,size:11}};
const FTL={id:'ftl',beforeDatasetsDraw(ch){
  if(FTI<0)return;
  const c=ch.ctx,x=ch.scales.x,y=ch.scales.yF;
  if(!x||!y)return;
  const px=x.getPixelForValue(FTI);
  c.save();
  c.fillStyle='rgba(26,115,181,.04)';c.fillRect(px,y.top,x.right-px,y.bottom-y.top);
  c.strokeStyle='rgba(26,115,181,.35)';c.lineWidth=1;c.setLineDash([5,4]);
  c.beginPath();c.moveTo(px,y.top);c.lineTo(px,y.bottom);c.stroke();
  c.restore();
}};

const FDS=[
  {label:'Pine Creek (obs)',data:fo_pinecreek,borderColor:'#1d4ed8',borderWidth:2,pointRadius:5,pointBackgroundColor:'#1d4ed8',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===0;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#1d4ed8',anchor:'end',align:'top',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:600},}},
  {label:'Pine Creek (pred)',data:fp_pinecreek,borderColor:'#1d4ed8',borderDash:[5,3],borderWidth:1.5,pointRadius:5,pointStyle:'triangle',pointBackgroundColor:'#1d4ed8',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===0;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#1d4ed8',anchor:'end',align:'top',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:500,style:'italic'},}},
  {label:'Moody (Fifteenmile Ck) (obs)',data:fo_moody,borderColor:'#15803d',borderWidth:2,pointRadius:5,pointBackgroundColor:'#15803d',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===1;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#15803d',anchor:'start',align:'bottom',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:600},}},
  {label:'Moody (Fifteenmile Ck) (pred)',data:fp_moody,borderColor:'#15803d',borderDash:[5,3],borderWidth:1.5,pointRadius:5,pointStyle:'triangle',pointBackgroundColor:'#15803d',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===1;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#15803d',anchor:'start',align:'bottom',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:500,style:'italic'},}},
  {label:'Kaser Bridge (Fifteenmile Ck) (obs)',data:fo_kaser,borderColor:'#7c3aed',borderWidth:2,pointRadius:5,pointBackgroundColor:'#7c3aed',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===2;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#7c3aed',anchor:'end',align:'top',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:600},}},
  {label:'Kaser Bridge (Fifteenmile Ck) (pred)',data:fp_kaser,borderColor:'#7c3aed',borderDash:[5,3],borderWidth:1.5,pointRadius:5,pointStyle:'triangle',pointBackgroundColor:'#7c3aed',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===2;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#7c3aed',anchor:'end',align:'top',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:500,style:'italic'},}},
  {label:'15/8 Mile Confluence (obs)',data:fo_fifteeneight,borderColor:'#0e7490',borderWidth:2,pointRadius:5,pointBackgroundColor:'#0e7490',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===3;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#0e7490',anchor:'start',align:'bottom',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:600},}},
  {label:'15/8 Mile Confluence (pred)',data:fp_fifteeneight,borderColor:'#0e7490',borderDash:[5,3],borderWidth:1.5,pointRadius:5,pointStyle:'triangle',pointBackgroundColor:'#0e7490',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===3;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#0e7490',anchor:'start',align:'bottom',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:500,style:'italic'},}},
  {label:'Eightmile Creek (obs)',data:fo_eightmile,borderColor:'#4338ca',borderWidth:2,pointRadius:5,pointBackgroundColor:'#4338ca',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===4;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#4338ca',anchor:'end',align:'top',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:600},}},
  {label:'Eightmile Creek (pred)',data:fp_eightmile,borderColor:'#4338ca',borderDash:[5,3],borderWidth:1.5,pointRadius:5,pointStyle:'triangle',pointBackgroundColor:'#4338ca',pointBorderWidth:1.5,tension:.3,fill:false,spanGaps:false,yAxisID:'yF',datalabels:{display:c=>{const i=c.dataIndex;if(c.dataset.data[i]===null)return false;return i%5===4;},formatter:v=>v!==null?v.toFixed(0)+' cfs':'',color:'#4338ca',anchor:'end',align:'top',offset:5,font:{family:"'IBM Plex Mono'",size:9,weight:500,style:'italic'},}},
];
new Chart(document.getElementById('flowChart'),{
  type:'line',data:{labels:FLB,datasets:FDS},
  options:{
    responsive:true,animation:{duration:500},
    layout:{padding:{top:20}},
    interaction:{mode:'index',intersect:false},
    plugins:{
      legend:{display:false},
      tooltip:{...TT,callbacks:{
        label:c=>{const v=c.parsed.y;return v!==null?c.dataset.label+': '+v.toFixed(1)+' cfs':''},
      }},
    },
    scales:{
      x:{...SD,ticks:{...SD.ticks,maxRotation:45}},
      yF:{...SD,position:'left',
        title:{display:true,text:'Discharge (cfs)',color:'#6b7b8d',font:CF},
        afterDataLimits(ax){
          const pad=(ax.max-ax.min)*0.12||5;
          ax.min=Math.max(0,ax.min-pad);ax.max=ax.max+pad;
        },
      },
    },
  },
  plugins:[FTL],
});
})();

</script>
</body>
</html>